---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  out.width = "100%"
)
```

<!-- badges: start -->
[![R build status](https://github.com/mpadge/gender-conscious-routing/workflows/R-CMD-check/badge.svg)](https://github.com/mpadge/gender-conscious-routing/actions?query=workflow%3AR-CMD-check)
[![codecov](https://codecov.io/gh/mpadge/gender-conscious-routing/branch/master/graph/badge.svg)](https://codecov.io/gh/mpadge/gender-conscious-routing)
[![Project Status: Concept](http://www.repostatus.org/badges/latest/concept.svg)](http://www.repostatus.org/#concept)
<!-- badges: end -->

# gender conscious routing

Routing along streets named after women rather than men.

*Disclaimer*: This package presumes that gender is binary. Which it is not. The
package and its developers neither endorse nor encourage viewing gender in
binary terms. This binary distinction is nevertheless hard-coded here because
the package relies on a library coded elsewhere to associate names with
genders, and which provides only binary definitions of gender. The library
nevertheless allows gender associations in a very wide variety of languages,
far more than any other equivalent library, and so allows the functionality of
this package to be applied to far greater regions of the world that would
other, non-binary alternatives. See the vignette for further detail on the
gender encoding system used here.

---

## Generating gender-conscious routes

The function `conscious_route()` calculates routes which preferentially
traverse streets named after women. Usage requires downloading a street
network, the simplest way of which is to use [the `dodgr`
package](https://github.com/atfutures/dodgr). It is good practice to save
networks locally, to avoid having to repeat calls to the Open Street Map
servers which deliver the data.

```{r, dodgr_streetnet_sc, eval = FALSE}
city <- "Aachen Germany"
net <- dodgr::dodgr_streetnet_sc (city)
saveRDS (net, "mynetwork.Rds")
```

The gender of all streets can then be appended to the network data with the
`gender_streetnet()` function, which also accepts an additional parameter,
`wt_profile`, used to specify the weighting profile from [the profiles of the
`dodgr`
package](https://atfutures.github.io/dodgr/reference/weighting_profiles.html).

```{r gender_streetnet, eval = FALSE}
library (genderconsciousrouting)
net <- gender_streetnet (dat, wt_profile = "foot")
```

Gender-conscious routes can then be generated by specifying start and end
points. The following example selects random points from the network vertices.

```{r verts, eval = FALSE}
v <- dodgr::dodgr_vertices (net)
set.seed (1)
start <- sample (v$id, size = 1L)
stop <- sample (v$id, size = 1L)
```

Those `id` values are the Open Street Map identifiers of two random vertices
(or "nodes" in Open Street Map terms) of the network. Finally, the following
code calculates the  path between them which traverses the greatest
proportional length along streets named after women:

```{r route, eval = FALSE}
conscious_route (net, start = start, stop = stop)
#> $p_stats
#>         d_female    d_non       ratio
#> default   0.0000 14253.97 0.000000000
#> female  134.9585 14229.33 0.009484535
#> 
#> $paths
#>      type                       geometry
#> 1 default LINESTRING (6.166698 50.812...
#> 2  female LINESTRING (6.166698 50.812...
#>
#> $points
#>               x        y    colour
#> 25722  6.166698 50.81288 #44FF22FF
#> 137140 6.020574 50.75566 #FF4422FF
```

The function returns a list of the following three items:

1. `p_stats` providing statistics on absolute and relative distances along the
   types of ways.
2. `paths` providing the path geometries, both of the gender-conscious route,
   and the "default" route which does not follow gender conscious paths; and
3. `points` with locations of the specified start and end points, along with
   colour codes which can be used to clearly indicate those points on
   interactive maps.
